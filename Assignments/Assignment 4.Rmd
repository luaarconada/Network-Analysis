---
title: "Assignment 4"
author: "Nile Ansotegi, Lúa Arconada and Alejandro Macías"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
    toc: yes
    toc_depth: 3
    number_sections: yes
    fig_width: 10.5
    fig_height: 7.5
    fig_caption: yes
    df_print: paged
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Required libraries and data

```{r, warning=FALSE, message=FALSE}
library(igraph)
set.seed(1234)
```

```{r}
data = read.table("congress.edgelist", sep="", header=F,
                  col.names=c("V1", "V2", "delete", "weight"))
data = data[,-3]
data$weight = gsub("}", '', data$weight)
data$weight = as.numeric(data$weight)
```

```{r}
data.attr = read.csv("gender-party.csv",sep=";", na.strings="")
data.attr$Gender = factor(data.attr$Gender)
data.attr$Party = factor(data.attr$Party)
```

```{r}
g = igraph::graph_from_data_frame(data)
# set vertex attributes
g = set_vertex_attr(g, "name", value=data.attr$Name)
g = set_vertex_attr(g, "gender", value=data.attr$Gender)
g = set_vertex_attr(g, "affiliation", value=data.attr$Party)
```


# Vertex centrality measures

There exist plenty of different measures of vertex centrality in networks. We will study our netowrk through some of the simplest or most famous ones: vertex degree, closeness, betweenness, eigenvector and PageRank.

## Vertex degree

We will start by applying the simplest centrality measure: vertex degree. Since we are dealing with a weighted directed network, all possible computations of the vertex degree will be taken into account.

We can start by computing the total vertex degree:

```{r}
total_deg = sort.int(degree(g), decreasing=T, index.return=T)
total_deg$x[1:5]
```

According to this measure, Mike Gallagher is the most central vertex, followed by Steve Cohen and Mike Bost. Centrality in this case does not necessarily represent the most influential nor influenced individuals, but rather those that might influence and/or be influenced by the most people. To get a better idea of the extent of the influence the weighted vertex degree should be calculated:

```{r}
total_weighted = sort(strength(g), decreasing=T, index.return=T)
total_weighted$x[1:5]
```

We obtain a similar scenario, in which Mike Gallagher is the vertex with more outgoing/ingoing influence and Maria Elvira Salazar also appears in the podium, although some other new Congresspeople appear when taking into account the weights. These new people are influenced or influence less people but in a stronger manner.

To really be able to tell whether these people are influencers or followers, or even a mix of both, the in- and out- degrees need to be calculated. We can start with the in-degrees:

```{r}
in_deg = sort.int(degree(g, mode="in"), decreasing=T, index.return=T)
in_deg$x[1:5]
```

Mike Gallagher and Maria Elvira Salazar appear once again, with the latter being even higher than before. Another well-known name that appears in the top 5 is that of Bernie Sanders. These central vertices (in terms of their in-degree) represent people that are influenced by a lot of different politicians in the US Congress. To make a better judgement, however, the weights have to be included in the computation:

```{r}
in_weighted = sort(strength(g, mode="in"), decreasing=T, index.return=T)
in_weighted$x[1:5]
```

Mike Gallagher stays at the top as the most influenced individual in US Congress. Some new names appear, only one of which (Morgan Griffith) appears at the top of the total weighted degrees. Bernie Sanders disappears from the top 5 (now being 9th), which indicates that he is influenced by a lot of people but not very strongly.

This process can be repeated for the out-degree to be able to discern the biggest influencers:

```{r}
out_deg = sort.int(degree(g, mode="out"), decreasing=T, index.return=T)
out_deg$x[1:5]
```

Mike Gallagher also appears as a person that influences many others, although just behind the first spot taken by Steve Cohen, who did not seem to be too influenced earlier. 

```{r}
out_weighted = sort(strength(g, mode="out"), decreasing=T, index.return=T)
out_weighted$x[1:5]
```

When taking into account the weights we see Steve Cohen stays on top, followed by Tom Rice and Mike Bost. All three of them appeared when considering the total weighted degree but were not present in the weighted in-degree, which indicates that they are influencers without being followers too, unlike Mike Gallagher.

## Closeness centrality

The next centrality measure studied is that of closeness centrality, which deals with the distances of vertices to one another. It is important to take into account that, as we saw in previous weeks, ours is a directed network with seven (strong) components. Since 6 out of the 7 components contain only one vertex each, the closeness centrality will be calculated only for the largest component.    

```{r}
components_g = components(g, mode="strong")
g_large = induced_subgraph(g, 
                           components_g$membership==which.max(components_g$csize))
closeness_g = sort(closeness(g_large, normalized=TRUE, mode="out", weights=rep(1,ecount(g_large))),
                             decreasing=TRUE, index.return=TRUE)
closeness_g$x[1:5]
```

Once again, we see some familiar names such as Steve Cohen, Mike Gallagher, or Mike Bost. The high closeness centrality of these Congresspeople indicates that, apart from influencing many people, they are the ones whose influence takes less intermediaries to reach those who are not directly influenced by them. As usual, however, weights should be taken into account before making any claim on the extent of influences of these people.

In order to include weights in the computation, it is important realize that in this network bigger weights indicate higher influence, and so a closer relationship between two Congresspeople. Therefore, when computing distances between vertices, they must be inversely proportional to the weights.

```{r}
weighted_closeness = sort.int(closeness(g_large, normalized=T, mode="out",
                                        weights=1/E(g_large)$weight),
                             decreasing=TRUE, index.return=TRUE)
weighted_closeness$x[1:10]
```

For the first five people, we obtain vastly different results to the ones seen up until this point, although when considering the first ten people instead, Mike Bost and Tom Rice appear once again. As opposed to standard closeness, weighted closeness is influenced by both the amount of intermediaries and how strong those intermediaries both influence and are influenced, that is, the individuals ranking at the top of weighted closeness are the ones that, although perhaps seeming unimportant at first, are able to truly influence other people the fastest, even if not directly due to their low vertex degree.


## Betweenness centrality

Next, betweenness centrality can be considered. This centrality measure assigns higher centrality to those vertices which are necessary to cross through in order to reach others, that is, intermediaries through which the influence must go in order to further spread.

```{r}
betweenness_g = sort(betweenness(g, normalized=T, directed=T, weights=rep(1,ecount(g))),
                     decreasing=T, index.return=T)
betweenness_g$x[1:5]
```
Once again, the same three names are repeated, together with two new ones.

Taking into account the weights of the network just as we did before:


```{r}
weighted_betweenness = sort(betweenness(g, normalized=T, directed=T, weights=1/E(g)$weight),
                     decreasing=T, index.return=T)
weighted_betweenness$x[1:5]
```
We see some already seen names, among which Mike Gallagher is far ahead of all others in terms of centrality. These individuals are the ones that, when taking influence into account, 


## Eigenvector centrality

The next centrality measure studied is that of eigenvector centrality, which is related to the "status" of a vertex within a network.

First, we consider standard eigenvector centrality:

```{r, warning=F}
eigen_g = sort(eigen_centrality(g, directed=T, scale=F, weights=rep(1,ecount(g)))$vector,
               decreasing=T, index.return=T)
eigen_g$x[1:5]
```

Once again, Mike Gallagher comes out on top, which indicates that he is an influencer within the US Congress network who at the same time influences a lot of other influencers.
We can repeat the computation taking the weights of the network into account:

```{r, warning=FALSE}
weighted_eigen = sort(eigen_centrality(g, directed=T, scale=F, weights=E(g)$weight)$vector,
               decreasing=T, index.return=T)
weighted_eigen$x[1:5]
```

When taking into account the weights, the ranking changes all except the first position, which is still held by Mike Gallagher. This but confirms his status as the individual who influences the most influencers.


## PageRank centrality

Finally, the last vertex centrality measure computed will be PageRank centrality, which is similar to eigenvector centrality.

```{r}
pagerank_g = sort(page_rank(g, weights=rep(1,ecount(g)))$vector,
            decreasing=T, index.return=T)
pagerank_g$x[1:5]
```

```{r}
weighted_pagerank = sort(page_rank(g, weights=E(g)$weight)$vector,
            decreasing=T, index.return=T)
weighted_pagerank$x[1:5]
```

Once again, we see Mike Gallagher come out on top of both standard and weighted PageRank centrality rankings, confirming his status of big influencer within the US Congress network.

# Edges centrality measures

In this section, we are going to focus on computing edge centrality. Unfortunately, most of the centrality measures for vertices cannot be easily extended to measure the centrality of edges. Therefore, we focus on the betweenness centrality that has a straightforward extension to the case of edges. For that, we use the function called `edge_betweenness` of the `igraph` library to obtain the betweenness centrality of the edges of our USA Congresspeople graph.

The betweenness centrality is a widely used measure for identifying central edges in a network. It quantifies the importance of an edge based on how often it lies on the shortest paths between pairs of nodes in the network. Edges with high betweenness centrality play a crucial role in maintaining efficient communication and connectivity within the network.

We first compute it without weights, but taking into account its directed nature. The betweenness centrality essentially measures how often an edge acts as a bridge or intermediary between different nodes. Edges with high betweenness centrality are crucial for maintaining efficient communication and connectivity within the network and the ones with the lowest are disposable.

In directed networks, betweenness centrality for an edge considers the directed nature of relationships between nodes. This means that the edge's directionality influences its contribution to the network's overall betweenness centrality.

```{r}
edge_centrality <- sort.int(edge_betweenness(g, weights=rep(1,ecount(g)), directed = TRUE),
                        decreasing=TRUE,index.return=TRUE)
edge_centrality$x[1:30]
```
We have computed the values of the betweenness centrality measure for all of our 13289 edges. We wanna see the ones with the highest values, in other words, the most influential edges in maintaining efficient connectivity in our graph.

```{r}
E(g)[edge_centrality$ix][1:10]
```

These are the most crucial connections if we only take into account which congresspeople interact. As we saw in the vertices centrality measures Mike Gallagher is a very central player in the graph. Its influenced and influences strongly other people, so it does not come as a surprise when we see it in our most crucial edges as both the begin and the end of edges.

High-betweenness edges are  essential for the connectivity of the graph. If these critical edges were to be eliminated from the network, it's highly likely that the paths between pairs of vertices would be severely impacted.

If we were to remove these crucial edges, it could disrupt the efficient communication and connectivity within the network. This disruption may lead to an increase in the distance between pairs of vertices, potentially making it more challenging for influence to flow between different parts of the network. Moreover, the removal of these critical edges could result in the network becoming fragmented, meaning that certain pairs of vertices may no longer have a path connecting them.

We now compute this measure with weights.

```{r}
edge_cent_weight <- sort.int(edge_betweenness(g, weights = 1/E(g)$weight, directed = TRUE),
                             decreasing = TRUE, index.return = TRUE)
edge_cent_weight$x[1:30]
```

The difference in the output between the two code chunks reflects the impact of considering edge weights on the calculation of edge betweenness centrality.

When not taking onto account the weights, the resulting edge betweenness centrality scores are generally lower. This is because each edge is treated equally in terms of its influence on the shortest paths between pairs of nodes. Consequently, the computed centrality scores tend to be lower.

On the other hand, when taking into account the weights of our graph, the resulting edge betweenness centrality scores are significantly higher. This is because the edge weights provide additional information about the importance of connections between the congresspeople. As a result, edges with higher weights contribute more to the calculation of betweenness centrality, leading to higher centrality scores.

Since the values are different, it is adequate to think that the congresspeople connected are different too.

```{r}
E(g)[edge_cent_weight$ix][1:10]
```

These connections are the most crucial when we consider, not only the existing interactions, but also the repetition of each one. These are in fact different edges from before. When taking into account the weights, the crucial edges for graph connectivity are different ones.

If we take a closer look at the congressperson Mike Gallagher, he has crucial edges in both settings. In the weightless graph, Mike Gallagher -> Mike Braun and Mike Gallagher-> Chris Coon; while in the weighted one, Mike Gallagher -> Nicole Malliotakis. We have seen that Mike Gallagher is crucial in the connectivity of both of our graphs, weighted and unweighted.

# Local density

## Cliques

Cliques are fundamental concepts in graph theory that represent fully connected subgraphs within a larger network. A clique is a subset of vertices in a graph where every pair of vertices is directly connected by an edge. In other words, in a clique, every vertex is adjacent to every other vertex within the subset.

Cliques are valuable in network analysis for various reasons since they provide insights into the structure and organization of networks by revealing cohesive subgroups or communities of nodes. Moreover, they can be used for tasks such as community detection, network visualization, and understanding social or communication patterns within networks. Furthermore, analyzing cliques can help identify influential nodes or groups of nodes that have strong connections with each other, indicating potential hubs of activity or influence within the network.

In this section, we aim to compute the set of cliques for our Congress network. However, since the calculation of cliques is typically performed on undirected networks, we need to create an undirected version of our graph first.

To achieve this, we'll make a copy of our original graph but convert it into an undirected graph. This process ensures that each directed edge in our original graph becomes an undirected edge in the new graph, allowing us to analyze cliques effectively.

By performing these steps, we'll be able to analyze the cliques within our Congress network effectively, gaining insights into cohesive subgroups or communities within the network of Congressional interactions.

```{r}
# Convert the directed graph to an undirected one
g_un <- as.undirected(g, mode = "collapse")
```

```{r}
# Compute the set of cliques for the undirected graph
cliques <- cliques(g_un)
length(cliques)
```

We can see that we have an enormous amount of cliques within our undirected graph. Let's see how many we have of each size.

```{r}
table(sapply(cliques,length))
```

We have, of course, $475$ cliques of size $1$, which correspond to our number of vertices. Moving on, we observe $10222$ cliques of size $2$. These cliques represent pairs of congresspeople who have established direct connections with each other. It's noteworthy that the number of cliques of size $2$ is not equal to the number of edges in our directed graph, which was $13289$. This discrepancy arises because, in the process of making our graph undirected, some edges were collapsed. Specifically, instances where pairs of congresspeople had reciprocal edges (one edge in each direction) were merged into a single undirected edge.

Moreover, we can see that we have $52333$ triangles (cliques of size $3$), $136659$ cliques of size $4$ and so on. Now, we are interested to see which vertices correspond to the $6$ cliques of size $13$ that we have.

```{r}
largest_cliques(g_un)
```

We can see that congressman Debbie Stabenow appears in several cliques, including those with Tony Cárdenas, Kat Cammack, Chuck Schumer, and others. These cliques indicate cohesive subgroups where members frequently interact or collaborate on legislative matters. Moreover, we can see an overlap in the cliques, congresswoman Kat Cammack is a member of cliques that also include Chuck Schumer, Debbie Stabenow, and Tony Cárdenas. This overlap suggests that Kat Cammack serves as a bridge between different cohesive subgroups within the network, facilitating communication and collaboration between them.

Furthermore, we can see a variety of congresspeople involves. For example, congressman John Larson, representing Connecticut's 1st congressional district, appears in cliques alongside representatives from diverse regions and political parties, such as Kat Cammack from Florida, Debbie Stabenow from Michigan, and Chuck Schumer from New York. This diversity reflects the broad range of interactions and collaborations within the Congress network.

In addition,  we observe some potential for bipartisanship, since senator Chuck Schumer, a Democrat from New York, is present in cliques that include both Democratic and Republican members, such as Debbie Stabenow, a Democrat, and Kat Cammack, a Republican. This indicates opportunities for bipartisanship and collaboration across party lines on legislative initiatives.

Finally, we can identify some key figures, because senator Chuck Schumer appears in multiple large cliques, including those with Debbie Stabenow, Kat Cammack, and others. His presence in these cliques suggests that he plays a central role in facilitating connections and interactions within the network, potentially influencing the flow of information and collaboration among members.

We have taken a look at the cliques of the largest order, but what about the other cliques? Are they maximal or are they just subgraphs from the $13$ largest cliques? To investigate this we are going to compute the maximal cliques of our graph.

```{r, warning = FALSE}
max_cliques <- max_cliques(g)
head(max_cliques, n = 30)
```

We can see that we have many small cliques, several cliques consist of only two congresspeople, such as Frederica Wilson and John Sarbanes, or Frederica Wilson and Frank Lucas. These smaller cliques may represent pairs of congresspeople who share common interests or frequently collaborate on specific issues. Moreover, there is some overlap between cliques, where certain congresspeople appear in multiple cliques. For example, John Yarmuth appears in cliques with different congresspeople, including Dina Titus, Chris Stewart, and Dan Bishop. This overlap suggests that John Yarmuth plays a bridging role between different cohesive subgroups within the network.

Moreover, the variety of the background of the present people in a graph remains presenting a diverse range of backgrounds, political affiliations, and regions. For instance, Joe Wilson interacts with Diana Harshbarger and Carlos Giménez in one clique and with Marco Rubio and Bill Johnson in another. This diversity reflects the broad spectrum of interactions and collaborations within the Congress network. Once again, we have members of different political parties (Democrat and Republican) collaborating. For example, Steve Womack interacts with both Marc Veasey and Patrick McHenry, suggesting opportunities for cooperation on legislative matters despite differing party affiliations.

A key figure that we can identify from these cliques is, for example, Donald Norcross, who is involved in several cliques with different combinations of congresspeople, indicating his central role in the network.

However, we have not seen what happened with those cliques of a higher order. For that we compute the following table:

```{r}
table(sapply(max_cliques,length))
```

We can see that none of the cliques of order $1$ are maximal cliques. Moreover, only $94$ out of the $10222$ cliques of degree $2$ are maximal cliques. Furthermore, out of the $52333$ cliques of order $3$, $1041$ are maximal. In general, the number of maximal cliques out of the total number of cliques at one degree is much smaller, except with degree $13$, where all are maximal cliques.

## Graph coreness

Graph coreness is a measure used in graph theory to quantify the structural centrality of nodes within a graph. It indicates how "deep" a node is within the core structure of the graph.

The coreness of a node is determined by recursively peeling away its neighbors and itself until it can no longer be removed without reducing the degree of its neighbors below a certain threshold. The highest coreness value in the graph is the coreness of the most central node.

Nodes with higher coreness values are considered more central to the overall structure of the graph, as they have more connections to other nodes that are also well-connected. Coreness is often used in network analysis to identify important nodes or to understand the robustness and resilience of a network.

```{r, warning = FALSE}
cores <- sort(coreness(g), decreasing = TRUE)
cores[1:10]
table(cores)
```

We can see that, the top $10$ nodes identified, including "Bill Cassidy," "Chris Coons," "Catherine Cortez Masto," "Tom Cotton," "Kevin Cramer," "Josh Hawley," "Martin Heinrich," "John Hickenlooper," "Mazie Hirono," and "John Hoeven," all possess the maximum coreness value of $35$. This collective maximum suggests a highly central position within the network, implying strong connections to other nodes.

Furthermore, the concentration of vertices with the highest coreness value of $35$ stands out prominently, encompassing $175$ out of $475$ vertices. This concentration underscores the existence of a core group of highly connected nodes, implying significant roles in information dissemination or influence propagation within the network.

As coreness values gradually decrease from the maximum value of 35 to lower values, we witness a diminishing count of vertices associated with each successive coreness level. Such a gradual decline in coreness values is characteristic of many networks, reflecting a diminishing level of centrality or influence as we move away from the most central nodes.

We can take a look at the vertices (congresspeople), which have the highest coreness value.

```{r}
which(cores==max(cores))
```

We delve further into the analysis of the coreness values of our network by plotting them in a histogram to have a visual representation and see if we can draw new insights.

```{r}
hist(cores,col='skyblue',
     main="Histogram for the k-cores in the Congresspeople network")
```

Firstly, we can see that the scarcity of vertices with low coreness values suggests that there are relatively few peripheral nodes with low connectivity or influence in the network. Instead, a large proportion of nodes appear to be rightly positioned, with higher coreness values indicating greater centrality and connectivity as we know.

Moreover, the sharp increase in the number of vertices with coreness values in the range of 30-35 indicates the formation of a core group of highly central nodes (the one we have been guessing). These nodes likely represent key influencers within the congresspeople network. The concentration of vertices with high coreness values suggests a cohesive network structure characterized by dense connections and strong interdependencies among nodes. This cohesion fosters efficient communication and facilitates the spread of information or influence across the network.

Finally, we generate the subgraph of our original graph containing only the vertices with the maximum coreness value (the highly central nodes), and then we extract the unique edges from that subgraph and display some of them.

```{r}
subgraph <- induced_subgraph(g, which(cores == max(cores)))
unique(E(subgraph))
```

```{r}
plot(subgraph, vertex.label.cex = 0.5, layout = layout_nicely, margin = 0.2, vertex.dist = 5.5)
```

Not very useful because we cannot see the network well. We have said that it shows that the graph may be dense, but we are going to compute its density to check.

## Density

Edge density is a measure used in graph theory to quantify how densely connected the vertices are within a graph. It represents the ratio of the actual number of edges in the graph to the total possible number of edges.

The formula for edge density is:

$$
\text{den(G)} = \frac{L}{N(N-1)},
$$

where $L$ is the number of edges in the graph $G$ and $N$ is the number of vertices in the graph $G$. Hence, the denominator $N(N-1)$ represents the total possible number of edges in our directed graph with $N$ vertices, since $N(N-1)$ represents all possible ordered pairs of $N$ vertices.

The density value spans from $0$ to $1$, reflecting the degree of connectivity within the graph. A density of $0$ signifies a sparse graph, indicating that the vertices are minimally connected, with numerous isolated components scattered throughout the graph. Conversely, a density of $1$ denotes a dense graph, where every possible edge is present, showcasing a high level of interconnectedness among the vertices and an abundance of direct connections linking them together.

```{r}
edge_density(g)
```

This output suggests that our graph is characterized by a relatively sparse structure, contrary to what we were suspecting. Consequently, our graph may exhibit numerous isolated components or disjointed clusters, with limited direct connections between vertices. Moreover, we can say that the graph lacks a high level of interconnectedness among its vertices.

We know look at how densely surrounded are a couple of previously mentioned vertices, Mike Gallagher and Bernie Sanders, by using their their ego networks. An ego network is a subgraph of the original graph, where the ego is the central node, and the alters are the neighboring nodes directly connected to the ego.

Firstly, we create an ego network centered around Mike Gallagher and, the, we calculate the edge density of that ego network. This edge density value provides insights into the level of connectivity within the ego network, specifically focusing on the connections involving "Mike Gallagher" and the vertices within a distance of 1 from him in the original graph.

```{r}
ego_mike_gallagher <- make_ego_graph(g,order=1,nodes=V(g)[212])
edge_density(ego_mike_gallagher[[1]])
```

The edge density is approximately $0.1196$. This suggests that the connections within this ego network are relatively sparse, with approximately $11.96%$ of the possible connections being present. This indicates that Mike Gallagher and the vertices within one hop of him are not extensively connected, with several potential edges remaining unutilized.

We do the same  with Bernie Sanders to be able to compare them.

```{r}
ego_bernie_sanders <- make_ego_graph(g,order=1,nodes=V(g)[71])
edge_density(ego_bernie_sanders[[1]])
```

The edge density is now approximately 0.1485, indicating a slightly higher density compared to Mike Gallagher's ego network, with approximately 14.85% of the possible connections present. The connections within this ego network are relatively denser, implying a higher level of connectivity among Bernie Sanders and the vertices within one hop of him. Bernie Sanders is more densely surrounded than Mike Gallagher, even though we observed that Mike Gallagher was more influential.

## Clustering coefficient (transitivity)

We will measure the density of the graph in an alternative way. Density of triangles among connected triplets is going to be taken into consideration. 

A triplet is a subgraph of three vertices connected by at least two edges. We denote $\tau_{\triangle}(G)$ the number of closet triplets (triangles) in a graph and $\tau_3(G)$ the number of all triplets in a graph. Then, the clustering coefficient or transitivity of a graph is 

$$
cl(G)=3\frac{\tau_{\triangle}(G)}{\tau_3(G)}
$$

Transitivity values lie between 0 and 1, providing a measure of global clustering. For this, undirected networks are considered instead of directed. 

```{r}
transitivity(g,type="global")
```
We see that the network is not very dense, thus, the relative frequency of triplets close to form triangles is not very high. 

# Connectivity 
## Components

We obtain the number of components of the network. First, we consider the weak case. We have a single components in this case, as we saw in a previous work. Thus, our network is weakly connected, where the component is the whole network. 

```{r}
comps_weak <- components(g,mode="weak")
comps_weak$no
comps_weak$csize
```

For the strong case, we have 7 components. However, if we check the size of the components, we see that we have a components of size $469$ and the rest of the components have size 1, thus they are isolated vertices. The big component represents $98.7%$ of the total number of congresspeople. 

```{r}
comps_strong <- components(g,mode="strong")
comps_strong$no
comps_strong$csize
```

```{r}
table(comps_strong$csize)
```

```{r}
max(comps_strong$csize)/vcount(g)
```

We consider the strong case and stract the single component that has size bigger than one. Then, we compute the mean length of all the shortest paths from or to the vertices in such component and check that this number is equal to $0.0063907$, which does not seem to be a large number. Then, we compute the clustering coefficient (transitivity) that is equal to $0.2710319$.

```{r}
gc <- induced_subgraph(g,vids=V(g)[comps_strong$membershi==7])
gc
```

```{r}
mean_distance(gc)
```

```{r}
transitivity(gc)
```

Therefore, the mean length of all the shortest paths from or to the vertices in the main component is small, while the clustering coefficient is not too big either. Therefore, it is not clear if the small world property appears to hold.

## Vertex and edge connectivity

Vertex connectivity refers to the minimum number of vertices that need to be removed in order to disconnect the graph. Edge connectivity is the minimum number of edges that need to be removed in order to disconnect the graph. 

In both cases, we obtain that the minimum number of vertices/edges to be removed is 1. 

If we look at the articulation points, we see that there are not single vertices that disconnect the network.

```{r}
vertex_connectivity(gc)
edge_connectivity(gc)
```

```{r}
art_gc <- articulation_points(gc)
art_gc
```